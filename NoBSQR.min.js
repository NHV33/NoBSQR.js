function NoBSQR(e){var o=this;e="object"==typeof e?e:{},o.revision=3,o.imageTypes={bmp:"image/bmp",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpg",png:"image/png","svg+xml":"image/svg+xml",tiff:"image/tiff",webp:"image/webp","x-icon":"image/x-icon"},o.toTable=e.toTable,o.domElement=o.toTable?document.createElement("div"):document.createElement("canvas"),o.url=e.url||"",o.size=e.size||300,o.qrc=!1,o.colorLight=e.colorLight||"#fff",o.colorDark=e.colorDark||"#000",o.ecclevel=e.ecclevel||1,o.noBorder=e.noBorder,o.borderSize=e.borderSize||0,o.textDisplay=e.textDisplay,o.textPosition=e.textPosition||"bottom",o.pixelRadius=e.pixelRadius||0,"hidden"===o.textPosition&&(o.textDisplay=!1),0!==o.borderSize&&!0!==o.noBorder||(o.noBorder=!0,o.borderSize=0),o.allowTextBorders=!o.noBorder&&o.borderSize>=20,(o.allowTextBorders||o.toTable)&&"center"!==o.textPosition||(o.ecclevel=4);var r,t,i,n,a,f,l,c=[],d=[],s=[],g=[],u=[],v=[],m=function(e,o){var r;e>o&&(r=e,e=o,o=r),r=o,r*=o,r+=o,r>>=1,g[r+=e]=1},p=function(e,o){var r;for(s[e+i*o]=1,r=-2;r<2;r++)s[e+r+i*(o-2)]=1,s[e-2+i*(o+r+1)]=1,s[e+2+i*(o+r)]=1,s[e+r+1+i*(o+2)]=1;for(r=0;r<2;r++)m(e-1,o+r),m(e+1,o-r),m(e-r,o-1),m(e+r,o+1)},b=function(e){for(;e>=255;)e=((e-=255)>>8)+(255&e);return e},h=function(e,o,r,t){var i,n,a,f=NoBSQR.gexp,l=NoBSQR.glog;for(i=0;i<t;i++)c[r+i]=0;for(i=0;i<o;i++){if(255!=(a=l[c[e+i]^c[r]]))for(n=1;n<t;n++)c[r+n-1]=c[r+n]^f[b(a+v[t-n])];else for(n=r;n<r+t;n++)c[n]=c[n+1];c[r+t-1]=255==a?0:f[b(a+v[0])]}},x=function(e,o){var r;return e>o&&(r=e,e=o,o=r),r=o,r+=o*o,r>>=1,g[r+=e]},B=function(e){var o,r,t,n;switch(e){case 0:for(r=0;r<i;r++)for(o=0;o<i;o++)o+r&1||x(o,r)||(s[o+r*i]^=1);break;case 1:for(r=0;r<i;r++)for(o=0;o<i;o++)1&r||x(o,r)||(s[o+r*i]^=1);break;case 2:for(r=0;r<i;r++)for(t=0,o=0;o<i;o++,t++)3==t&&(t=0),t||x(o,r)||(s[o+r*i]^=1);break;case 3:for(n=0,r=0;r<i;r++,n++)for(3==n&&(n=0),t=n,o=0;o<i;o++,t++)3==t&&(t=0),t||x(o,r)||(s[o+r*i]^=1);break;case 4:for(r=0;r<i;r++)for(t=0,n=r>>1&1,o=0;o<i;o++,t++)3==t&&(t=0,n=!n),n||x(o,r)||(s[o+r*i]^=1);break;case 5:for(n=0,r=0;r<i;r++,n++)for(3==n&&(n=0),t=0,o=0;o<i;o++,t++)3==t&&(t=0),(o&r&1)+!(!t|!n)||x(o,r)||(s[o+r*i]^=1);break;case 6:for(n=0,r=0;r<i;r++,n++)for(3==n&&(n=0),t=0,o=0;o<i;o++,t++)3==t&&(t=0),(o&r&1)+(t&&t==n)&1||x(o,r)||(s[o+r*i]^=1);break;case 7:for(n=0,r=0;r<i;r++,n++)for(3==n&&(n=0),t=0,o=0;o<i;o++,t++)3==t&&(t=0),(t&&t==n)+(o+r&1)&1||x(o,r)||(s[o+r*i]^=1)}},S=function(e){var o,r=0;for(o=0;o<=e;o++)u[o]>=5&&(r+=NoBSQR.N1+u[o]-5);for(o=3;o<e-1;o+=2)u[o-2]==u[o+2]&&u[o+2]==u[o-1]&&u[o-1]==u[o+1]&&3*u[o-1]==u[o]&&(0==u[o-3]||o+3>e||3*u[o-3]>=4*u[o]||3*u[o+3]>=4*u[o])&&(r+=NoBSQR.N3);return r},N=function(){var e,o,r,t,n,a=0,f=0;for(o=0;o<i-1;o++)for(e=0;e<i-1;e++)(s[e+i*o]&&s[e+1+i*o]&&s[e+i*(o+1)]&&s[e+1+i*(o+1)]||!(s[e+i*o]||s[e+1+i*o]||s[e+i*(o+1)]||s[e+1+i*(o+1)]))&&(a+=NoBSQR.N2);for(o=0;o<i;o++){for(u[0]=0,r=t=e=0;e<i;e++)(n=s[e+i*o])==t?u[r]++:u[++r]=1,f+=(t=n)?1:-1;a+=S(r)}f<0&&(f=-f);var l=f,c=0;for(l+=l<<2,l<<=1;l>i*i;)l-=i*i,c++;for(a+=c*NoBSQR.N4,e=0;e<i;e++){for(u[0]=0,r=t=o=0;o<i;o++)(n=s[e+i*o])==t?u[r]++:u[++r]=1,t=n;a+=S(r)}return a};o.genframe=function(e){var o,u,S,R,Q,k,w,T,y=NoBSQR.eccblocks,C=NoBSQR.gexp,z=NoBSQR.glog;R=e.length,t=0;do{if(t++,S=4*(r-1)+16*(t-1),n=y[S++],a=y[S++],f=y[S++],l=y[S],R<=(S=f*(n+a)+a-3+(t<=9)))break}while(t<40);for(i=17+4*t,Q=f+(f+l)*(n+a)+a,R=0;R<Q;R++)d[R]=0;for(c=e.slice(0),R=0;R<i*i;R++)s[R]=0;for(R=0;R<(i*(i+1)+1)/2;R++)g[R]=0;for(R=0;R<3;R++){for(S=0,u=0,1==R&&(S=i-7),2==R&&(u=i-7),s[u+3+i*(S+3)]=1,o=0;o<6;o++)s[u+o+i*S]=1,s[u+i*(S+o+1)]=1,s[u+6+i*(S+o)]=1,s[u+o+1+i*(S+6)]=1;for(o=1;o<5;o++)m(u+o,S+1),m(u+1,S+o+1),m(u+5,S+o),m(u+o+1,S+5);for(o=2;o<4;o++)s[u+o+i*(S+2)]=1,s[u+2+i*(S+o+1)]=1,s[u+4+i*(S+o)]=1,s[u+o+1+i*(S+4)]=1}if(t>1)for(R=NoBSQR.adelta[t],u=i-7;;){for(o=i-7;o>R-3&&(p(o,u),!(o<R));)o-=R;if(u<=R+9)break;p(6,u-=R),p(u,6)}for(s[8+i*(i-8)]=1,u=0;u<7;u++)m(7,u),m(i-8,u),m(7,u+i-7);for(o=0;o<8;o++)m(o,7),m(o+i-8,7),m(o,i-8);for(o=0;o<9;o++)m(o,8);for(o=0;o<8;o++)m(o+i-8,8),m(8,o);for(u=0;u<7;u++)m(8,u+i-7);for(o=0;o<i-14;o++)1&o?(m(8+o,6),m(6,8+o)):(s[8+o+6*i]=1,s[6+i*(8+o)]=1);if(t>6)for(R=NoBSQR.vpat[t-7],S=17,o=0;o<6;o++)for(u=0;u<3;u++,S--)1&(S>11?t>>S-12:R>>S)?(s[5-o+i*(2-u+i-11)]=1,s[2-u+i-11+i*(5-o)]=1):(m(5-o,2-u+i-11),m(2-u+i-11,5-o));for(u=0;u<i;u++)for(o=0;o<=u;o++)s[o+i*u]&&m(o,u);for(Q=c.length,k=0;k<Q;k++)d[k]=c.charCodeAt(k);if(c=d.slice(0),Q>=(o=f*(n+a)+a)-2&&(Q=o-2,t>9&&Q--),k=Q,t>9){for(c[k+2]=0,c[k+3]=0;k--;)R=c[k],c[k+3]|=255&R<<4,c[k+2]=R>>4;c[2]|=255&Q<<4,c[1]=Q>>4,c[0]=64|Q>>12}else{for(c[k+1]=0,c[k+2]=0;k--;)R=c[k],c[k+2]|=255&R<<4,c[k+1]=R>>4;c[1]|=255&Q<<4,c[0]=64|Q>>4}for(k=Q+3-(t<10);k<o;)c[k++]=236,c[k++]=17;for(v[0]=1,k=0;k<l;k++){for(v[k+1]=1,w=k;w>0;w--)v[w]=v[w]?v[w-1]^C[b(z[v[w]]+k)]:v[w-1];v[0]=C[b(z[v[0]]+k)]}for(k=0;k<=l;k++)v[k]=z[v[k]];for(S=o,u=0,k=0;k<n;k++)h(u,f,S,l),u+=f,S+=l;for(k=0;k<a;k++)h(u,f+1,S,l),u+=f+1,S+=l;for(u=0,k=0;k<f;k++){for(w=0;w<n;w++)d[u++]=c[k+w*f];for(w=0;w<a;w++)d[u++]=c[n*f+k+w*(f+1)]}for(w=0;w<a;w++)d[u++]=c[n*f+k+w*(f+1)];for(k=0;k<l;k++)for(w=0;w<n+a;w++)d[u++]=c[o+k+w*l];for(c=d,o=u=i-1,S=Q=1,T=(f+l)*(n+a)+a,k=0;k<T;k++)for(R=c[k],w=0;w<8;w++,R<<=1){128&R&&(s[o+i*u]=1);do{Q?o--:(o++,S?0!=u?u--:(S=!S,6==(o-=2)&&(o--,u=9)):u!=i-1?u++:(S=!S,6==(o-=2)&&(o--,u-=8))),Q=!Q}while(x(o,u))}for(c=s.slice(0),R=0,u=3e4,S=0;S<8&&(B(S),(o=N())<u&&(u=o,R=S),7!=R);S++)s=c.slice(0);for(R!=S&&B(R),u=NoBSQR.fmtword[R+(r-1<<3)],S=0;S<8;S++,u>>=1)1&u&&(s[i-1-S+8*i]=1,S<6?s[8+i*S]=1:s[8+i*(S+1)]=1);for(S=0;S<7;S++,u>>=1)1&u&&(s[8+i*(i-7+S)]=1,S?s[6-S+8*i]=1:s[7+8*i]=1);return s},o.init=function(){r=o.ecclevel;var e=o.genframe(o.url);o.toTable?o.tableWrite(e,i):o.canvasWrite(e,i)},o.init()}NoBSQR.prototype={canvasWrite:function(e,o){var r=this;if(!r.qrc&&(r.qrc=r.getContext(r.domElement),!r.qrc))return r.toTable=!0,r.domElement=document.createElement("div"),void r.tableWrite(e,o);var t=r.size,i=r.qrc,n=t+2*r.borderSize,a=t/o,f=r.borderSize;r.noBorder?(i.canvas.width=i.canvas.height=t,f=0):i.canvas.width=i.canvas.height=n,i.clearRect(0,0,n,n),i.fillStyle=r.colorLight,i.fillRect(0,0,n,n),i.fillStyle=r.colorDark;for(var l=0;l<o;l++)for(var c=0;c<o;c++)e[c*o+l]&&(i.beginPath(),i.roundRect(a*l+f,a*c+f,1.05*a,1.05*a,[r.pixelRadius]),i.fill());if(!1===r.textDisplay)return;i.textAlign="center",i.textBaseline="middle";let d=.8*r.borderSize,s=n-r.borderSize/2;"top"===r.textPosition&&(s=r.borderSize/2),r.allowTextBorders&&"center"!==r.textPosition||(s=n/2,d=n/8),i.font=`bold ${d}px monospace`;let g=i.measureText(r.url).width,u=0;for(;u<100&&g>.95*n;)d-=3,i.font=`bold ${d}px monospace`,g=i.measureText(r.url).width,u+=1;console.log(r.ecclevel),i.lineWidth=d/5,i.strokeStyle=r.colorDark,i.fillStyle=r.colorLight,i.strokeText(r.url,n/2,s),i.fillText(r.url,n/2,s)},tableWrite:function(e,o){var r=this,t=Math.round(this.size/o-3.5),i=Math.ceil(r.borderSize/t),n=t+"px",a=o+(r.noBorder?0:2*i),f=i,l="width:"+n+";height:"+n+";",c=r.colorLight,d=r.colorDark,s=document.createElement("table");s.style.cssText="border:0;border-collapse:collapse;";for(var g,u=document.createElement("tr"),v=document.createElement("td"),m=function(){return v.cloneNode()},p=function(){var e=m();return e.style.cssText=l+"background:"+c,e},b=function(e){for(var o=e.firstChild,r=0;r<f;r++)e.insertBefore(p(),o),e.appendChild(p())},h=0;h<o;h++){var x=u.cloneNode();s.appendChild(x);for(var B=0;B<o;B++)if(1===e[h*o+B]){var S=(g=void 0,(g=m()).style.cssText=l+"background:"+d,g);x.appendChild(S)}else{var N=p();x.appendChild(N)}r.noBorder||b(x)}r.noBorder||function(e){for(var o=e.firstChild,r=0;r<i;r++){for(var t=u.cloneNode(),n=0;n<a;n++){var f=p();t.appendChild(f)}e.appendChild(t),e.insertBefore(t.cloneNode(!0),o)}}(s),r.domElement.innerHTML="",r.domElement.appendChild(s)},getContext:function(e){return e.getContext&&e.getContext("2d")?e.getContext("2d"):(console.log("Browser does not have 2d Canvas support"),!1)},toImage:function(e){if(this.qrc){var o=this.imageTypes[e];if(!o)throw new Error(e+" is not a valid image type ");var r=new Image;return r.src=this.domElement.toDataURL(o),r}}},NoBSQR.adelta=[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28],NoBSQR.vpat=[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177],NoBSQR.fmtword=[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],NoBSQR.eccblocks=[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],NoBSQR.glog=[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175],NoBSQR.gexp=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],NoBSQR.N1=3,NoBSQR.N2=3,NoBSQR.N3=40,NoBSQR.N4=10;